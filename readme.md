# SinoAdsPod integration document

## 1. Add SinoAdsPod to the xcode project

SinoAdsPod can be integrated into xcode projects via Cocoapods.
Please add the following code to your `Podfile`:####
```
pod "SinoAds"
```
The current latest version is 0.0.4

&nbsp;

Add the following code to the project's `info.plist`:
```xml
<key>NSAppTransportSecurity</key>
<dict>
    <key>NSAllowsArbitraryLoads</key>
    <true/>
</dict>
```

&nbsp;

## 2. Add code

### 2.1 Initialize SinoAds

`import` header file `<SinoAds/SinoAds.h>` in `AppDelegate.m`:

Objective-C:
```Objective-C
#import <SinoAds/SinoAds.h>
```
Swift:
```Swift
import SinoAds
```

&nbsp;

Initialize sdk in `- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`:

Objective-C:
```Objective-C
[[SA shared] setAppId:@"Your appId" andAppSecret:@"Your appSecret"];
```
Swift:
```Swift
SA.shared()?.setAppId("Your appId", andAppSecret: "Your appSecret")
```
>"Your appId" and "Your appSecret" need to be obtained from the background configuration.

&nbsp;

If you want to use `RewardedVideoAd`, you need to set `deviceId`, the code is as follows:

Objective-C:
```Objective-C
[[SA shared] setDeviceId:@"Your deviceId"];
```
Swift:
```Swift
SA.shared()?.setDeviceId("Your deviceId")
```

&nbsp;

`deviceId` can be generated by you on demand, or use the device's `IDFV`, the code is as follows:

Objective-C:
```Objective-C
[[[UIDevice currentDevice] identifierForVendor] UUIDString]
```
Swift:
```Swift
UIDevice.current.identifierForVendor?.uuidString
```

&nbsp;

### 2.2 Set user information (optional)

Set the user gender, the code is as follows:
Objective-C:
```Objective-C
[[SA shared] setUserGender:User gender];
```
Swift:
```Swift
SA.shared()?.setUserGender(User gender)
```

&nbsp;

User gender options are as follows:

Objective-C:
```Objective-C
SAUserGenderUnknown,
SAUserGenderMan,
SAUserGenderWoman
```
Swift:
```Swift
SAUserGender.unknown
SAUserGender.man
SAUserGender.woman
```

&nbsp;

Set the user age, the code is as follows:

Objective-C:
```Objective-C
[[SA shared] setUserAge:User age];
```
Swift:
```Swift
SA.shared()?.setUserAge(User age)
```

&nbsp;

Set whether the application supports payment. The default value is `NO`. The code is as follows:

Objective-C:
```Objective-C
[[SA shared] setIsPaidApp:NO];
```
Swift:
```Swift
SA.shared()?.setIsPaidApp(false)
```

&nbsp;

Set whether to display debug information, the code is as follows:

Objective-C:
```Objective-C
[[SA shared] setEnableLog:YES];
```
Swift:
```Swift
SA.shared()?.setEnableLog(true)
```

&nbsp;

### 2.3 Integrate `InterstitialAd`

#### 2.3.1 Initialize `InterstitialAd`, the code is as follows:

Objective-C:
```Objective-C
SAInterstitial *interstitial = [[SAInterstitial alloc] initWithUnitId:@"Your unitId"];
```
Swift:
```Swift
var interstitial: SAInterstitial? = SAInterstitial(unitId: "Your unitId")
```
> "Your unitId" needs to be obtained from the background configuration.

&nbsp;

#### 2.3.2 Set the `InterstitialAd` delegate, the code is as follows:

Objective-C:
```Objective-C
interstitial.delegate = self;
```
Swift:
```Swift
interstitial?.setDelegate(self)
```

&nbsp;

#### 2.3.3 Load `InterstitialAd`, the code is as follows:

Objective-C:
```Objective-C
[interstitial load];
```
Swift:
```Swift
interstitial?.load()
```
> After each ad is played, you need to call the ‘load’ method to reload the new ad. You can't replay the cached ad.

&nbsp;

#### 2.3.4 Implement `SAInterstitialDelegate` with the following code:

Objective-C:
```Objective-C
//Ad loaded successfully
- (void)interstitialDidLoad:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialDidLoad");
}

//Ad video loaded successfully
- (void)interstitialVideoDidLoad:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialVideoDidLoad");
}

//Ad failed to load
- (void)interstitial:(SAInterstitial * _Nonnull)interstitial didFailToLoadWithError:(NSError * _Nonnull)error {
    NSLog(@"interstitial didFailToLoadWithError %ld", (long)[error code]);
}

//Ad is about to show
- (void)interstitialWillPresentScreen:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialWillPresentScreen");
}

//Ad has been shown
- (void)interstitialDidPresentScreen:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialDidPresentScreen");
}

//Ad display failed
- (void)interstitial:(SAInterstitial * _Nonnull)interstitial didFailToPresentScreenWithError:(NSError * _Nonnull)error {
    NSLog(@"interstitial didFailToPresentScreenWithError %ld", (long)[error code]);
}

//Ad completed display
- (void)interstitialDidPlayFinish:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialDidPlayFinish %@ %@", [interstitial getUnitId], [interstitial getSdkName]);
}

//Ad is about to close
- (void)interstitialWillDismissScreen:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialWillDismissScreen");
}

//Ad is closed
- (void)interstitialDidDismissScreen:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialDidDismissScreen");
}

//User clicks on the ad
- (void)interstitialDidClick:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialDidClick");
}

//User clicks to skip
- (void)interstitialDidClickSkip:(SAInterstitial * _Nonnull)interstitial {
    NSLog(@"interstitialDidClickSkip");
}
```
Swift:
```Swift
//Ad loaded successfully
func interstitialDidLoad(_ interstitial: SAInterstitial) {
    print("interstitialDidLoad")
}

//Ad video loaded successfully
func interstitialVideoDidLoad(_ interstitial: SAInterstitial) {
    print("interstitialVideoDidLoad");
}

//Ad failed to load
func interstitial(_ interstitial: SAInterstitial, didFailToLoadWithError error: Error) {
    print("interstitial didFailToLoadWithError \((error as NSError).code)")
}

//Ad is about to show
func interstitialWillPresentScreen(_ interstitial: SAInterstitial) {
    print("interstitialWillPresentScreen")
}

//Ad has been shown
func interstitialDidPresentScreen(_ interstitial: SAInterstitial) {
    print("interstitialDidPresentScreen")
}

//Ad display failed
func interstitial(_ interstitial: SAInterstitial, didFailToPresentScreenWithError error: Error) {
    print("interstitial didFailToPresentScreenWithError \((error as NSError).code)")
}

//Ad completed display
func interstitialDidPlayFinish(_ interstitial: SAInterstitial) {
    print("interstitialDidPlayFinish \(interstitial.getUnitId() ?? "") \(interstitial.getSdkName() ?? "")")
}

//Ad is about to close
func interstitialWillDismissScreen(_ interstitial: SAInterstitial) {
    print("interstitialWillDismissScreen")
}

//Ad is closed
func interstitialDidDismissScreen(_ interstitial: SAInterstitial) {
    print("interstitialDidDismissScreen")
}

//User clicks on the ad
func interstitialDidClick(_ interstitial: SAInterstitial) {
    print("interstitialDidClick")
}

//User clicks to skip
func interstitialDidClickSkip(_ interstitial: SAInterstitial) {
    print("interstitialDidClickSkip")
}
```

&nbsp;

#### 2.3.5 Determine if `SAInterstitial` is successfully cached. If the cache is successful, play `SAInterstitial`. The code is as follows:

Objective-C:
```Objective-C
if ([interstitial isReady]) {
    [interstitial presentFromRootViewController:RootViewController];
}
```
Swift:
```Swift
if (interstitial?.isReady() ?? false) {
    interstitial?.present(fromRootViewController: RootViewController)
}
```

&nbsp;

`RootViewController` can be obtained as follows:

Objective-C:
```Objective-C
UIViewController *rootViewController = [UIApplication sharedApplication].keyWindow.rootViewController;
```
Swift:
```Swift
let rootViewController = UIApplication.shared.keyWindow?.rootViewController
```

&nbsp;

#### 2.3.6 It is recommended to reload the ad in `- (void)interstitialDidDismissScreen:(SAInterstitial * _Nonnull)interstitial`, as follows:

Objective-C:
```Objective-C
[self->interstitial load];
```
Swift:
```Swift
self.interstitial?.load();
```

&nbsp;

### 2.4 Integrate `RewardedVideoAd`

#### 2.4.1 Initialize `RewardedVideoAd`, the code is as follows:

Objective-C:
```Objective-C
SARewardedVideo *rewardedVideo = [[SARewardedVideo alloc] initWithUnitId:@"Your unitId" andExtraData:nil];
```
Swift:
```Swift
var rewardedVideo: SARewardedVideo? = SARewardedVideo(unitId: "Your unitId", andExtraData: nil)
```
>"Your unitId" needs to be obtained from the background configuration.

&nbsp;

#### 2.4.2 Set the `RewardedVideoAd` delegate, the code is as follows:

Objective-C:
```Objective-C
rewardedVideo.delegate = self;
```
Swift:
```Swift
rewardedVideo?.setDelegate(self)
```

&nbsp;

#### 2.4.3 Load `RewardedVideoAd`, the code is as follows:

Objective-C:
```Objective-C
[rewardedVideo load];
```
Swift:
```Swift
rewardedVideo?.load()
```
> After each ad is played, you need to call the ‘load’ method to reload the new ad. You can't replay the cached ad.

&nbsp;

#### 2.4.4 Implement `SARewardedVideoDelegate` with the following code:

Objective-C:
```Objective-C
//Ad is successfully played, returning the extraData passed in when the ad was created.
- (void)rewardedVideo:(SARewardedVideo * _Nonnull)rewardedVideo finishWithExtraData:(SAExtraData * _Nullable)extraData {
    NSLog(@"rewardedVideo finishWithExtraData");
}

//Ad is failed to play
- (void)rewardedVideo:(SARewardedVideo * _Nonnull)rewardedVideo finishWithError:(NSError * _Nonnull)error {
    NSLog(@"rewardedVideo finishWithError");
}

//Ad server verification is completed, returning verify to YES, the server verifies successfully.
- (void)rewardedVideoServerRewardDidSucceed:(SARewardedVideo * _Nonnull)rewardedVideo withVerify:(BOOL)verify {
    NSLog(@"rewardedVideoServerRewardDidSucceed %d", verify ? 1 : 0);
}

//Ad server verification failed
- (void)rewardedVideoServerRewardDidFail:(SARewardedVideo * _Nonnull)rewardedVideo {
    NSLog(@"rewardedVideoServerRewardDidFail");
}

//Ad is loaded successfully
- (void)rewardedVideoDidLoad:(SARewardedVideo * _Nonnull)rewardedVideo {
    NSLog(@"rewardedVideoDidLoad");
}

//Ad is failed to load
- (void)rewardedVideo:(SARewardedVideo * _Nonnull)rewardedVideo didFailToLoadWithError:(NSError * _Nonnull)error {
    NSLog(@"rewardedVideo didFailToLoadWithError %ld", (long)[error code]);
}

//Ad is about to show
- (void)rewardedVideoWillPresentScreen:(SARewardedVideo * _Nonnull)rewardedVideo {
    NSLog(@"rewardedVideoWillPresentScreen");
}

//Ad has been shown
- (void)rewardedVideoDidPresentScreen:(SARewardedVideo * _Nonnull)rewardedVideo {
    NSLog(@"rewardedVideoDidPresentScreen");
}

//Ad is about to close
- (void)rewardedVideoWillDismissScreen:(SARewardedVideo * _Nonnull)rewardedVideo {
    NSLog(@"rewardedVideoWillDismissScreen");
}

//Ad is closed
- (void)rewardedVideoDidDismissScreen:(SARewardedVideo * _Nonnull)rewardedVideo {
    NSLog(@"rewardedVideoDidDismissScreen");
}

//User clicks on the ad
- (void)rewardedVideoDidClick:(SARewardedVideo * _Nonnull)rewardedVideo {
    NSLog(@"rewardedVideoDidClick");
}
```
Swift:
```Swift
//The ad is successfully played, returning the extraData passed in when the ad was created.
func rewardedVideo(_ rewardedVideo: SARewardedVideo, finishWith extraData: SAExtraData?) {
    print("rewardedVideo finishWithExtraData")
}

//Ad is failed to play
func rewardedVideo(_ rewardedVideo: SARewardedVideo, finishWithError error: Error) {
    print("rewardedVideo finishWithError")
}

//Ad server verification is completed, returning verify to true, the server verifies successfully.
func rewardedVideoServerRewardDidSucceed(_ rewardedVideo: SARewardedVideo, withVerify verify: Bool) {
    print("rewardedVideoServerRewardDidSucceed \(verify)")
}

//Ad server verification failed
func rewardedVideoServerRewardDidFail(_ rewardedVideo: SARewardedVideo) {
    print("rewardedVideoServerRewardDidFail")
}

//Ad is loaded successfully
func rewardedVideoDidLoad(_ rewardedVideo: SARewardedVideo) {
    print("rewardedVideoDidLoad")
}

//Ad is failed to load
func rewardedVideo(_ rewardedVideo: SARewardedVideo, didFailToLoadWithError error: Error) {
    print("rewardedVideo didFailToLoadWithError \((error as NSError).code)")
}

//Ad is about to show
func rewardedVideoWillPresentScreen(_ rewardedVideo: SARewardedVideo) {
    print("rewardedVideoWillPresentScreen")
}

//Ad has been shown
func rewardedVideoDidPresentScreen(_ rewardedVideo: SARewardedVideo) {
    print("rewardedVideoDidPresentScreen")
}

//Ad is about to close
func rewardedVideoWillDismissScreen(_ rewardedVideo: SARewardedVideo) {
    print("rewardedVideoWillDismissScreen")
}

//Ad is closed
func rewardedVideoDidDismissScreen(_ rewardedVideo: SARewardedVideo) {
    print("rewardedVideoDidDismissScreen")
}

//User clicks on the ad
func rewardedVideoDidClick(_ rewardedVideo: SARewardedVideo) {
    print("rewardedVideoDidClick")
}
```

&nbsp;

#### 2.4.5 Determine if `SARewardedVideo` is successfully cached. If the cache is successful, play `SARewardedVideo`. The code is as follows:

Objective-C:
```Objective-C
if ([rewardedVideo isReady]) {
    [rewardedVideo presentFromRootViewController:RootViewController];
}
```
Swift:
```Swift
if (rewardedVideo?.isReady() ?? false) {
    rewardedVideo?.present(fromRootViewController: RootViewController)
}
```

&nbsp;

`RootViewController` can be obtained as follows:

Objective-C:
```Objective-C
UIViewController *rootViewController = [UIApplication sharedApplication].keyWindow.rootViewController;
```
Swift:
```Swift
let rootViewController = UIApplication.shared.keyWindow?.rootViewController
```

&nbsp;

#### 2.4.6 After the ad is successfully played, the following interface `- (void)rewardedVideo:(SARewardedVideo * _Nonnull)rewardedVideo finishWithExtraData:(SAExtraData * _Nullable)extraData` is called, and the success status can be processed here.

&nbsp;

#### 2.4.7 It is recommended to reload the ad in `- (void)rewardedVideoDidDismissScreen:(SARewardedVideo * _Nonnull)rewardedVideo` with the following code:

Objective-C:
```Objective-C
[self->rewardedVideo load];
```
Swift:
```Swift
self.rewardedVideo?.load()
```

&nbsp;

### 2.5 Set `SAExtraData` (optional)

When initializing `SARewardedVideo`, you can set the `SAExtraData` data.
The `SAExtraData` data will be returned to the client in `- (void)rewardedVideo:(SARewardedVideo * _Nonnull)rewardedVideo finishWithExtraData:(SAExtraData * _Nullable)reward`.
The data structure is as follows:

Objective-C:
```Objective-C
NSString* type;//Type of video reward
NSInteger amount;//Number of video rewards
NSString* data;//Additional postback information
```
Swift:
```Swift
var type: String!//Type of video reward
var amount: Int//Number of video rewards
var data: String!//Additional postback information
```

&nbsp;

The code to create and use `SAExtraData` is as follows:

Objective-C:
```Objective-C
SAExtraData* extraData = [[SAExtraData alloc] init];
[extraData setType:@"Skill"];
[extraData setAmount:1];
[extraData setData:@"ExtraData"];

SARewardedVideo *rewardedVideo = [[SARewardedVideo alloc] initWithUnitId:@"Your unitId" andExtraData:extraData];
```
Swift:
```Swift
let extraData = SAExtraData()
extraData?.type = "Skill"
extraData?.amount = 1
extraData?.data = "ExtraData"

var rewardedVideo: SARewardedVideo? = SARewardedVideo(unitId: "Your unitId", andExtraData: extraData)
```

&nbsp;

`SAExtraData` can be reset before each `load`:

Objective-C:
```Objective-C
[rewardedVideo setExtraData:extraData];
[rewardedVideo load];
```
Swift:
```Swift
rewardedVideo?.setExtraData(extraData)
rewardedVideo?.load()
```

&nbsp;

### 2.6 Ad Error code

Common error codes are as follows:
```Objective-C
SAErrorCodeNoAdError = 0,                 //Parsed data has no ads
SAErrorCodeNetError = 1,                  //Network request failed
SAErrorCodeParseError = 2,                //Parsing failure
SAErrorCodeParamEroor = 3,                //Parameter error
SAErrorCodeTimeout = 4,                   //Time out
SAErrorCodeSuccess = 5,                   //Success
SAErrorCodeNoAd = 6,                      //No ads
SAErrorCodeContentType = 7,               //Http conent_type error
SAErrorCodeRequestPBError = 8,            //Http request pb error
SAErrorCodeAppEmpty = 9,                  //Request app can't be empty
SAErrorCodeWapEmpty = 10,                 //Request wap cannot be empty
SAErrorCodeAdSlotEmpty = 11,              //Missing ad unit description
SAErrorCodeAdSlotSizeEmpty = 12,          //Ad unit size is illegal
SAErrorCodeAdSlotIdError = 13,            //Ad unit ID is illegal
SAErrorCodeAdCountError = 14,             //Requested ad number error
SAErrorCodeSysError = 15,                 //Ad server error
SAErrorCodeSizeError = 16,                //The material size is not filled or the material size is larger than 10000
SAErrorCodeUnionAdSiteIdError = 17,       //The media is empty or not running
SAErrorCodeUnionRequestInvalidError = 18, //App status is invalid
SAErrorCodeUnionAppSiteRelError = 19,     //App ID error
SAErrorCodeBundleNameError = 20,          //Bundle name error
```

&nbsp;

### 2.7 Network error code

Common error codes are as follows:
```Objective-C
SAHttpErrorCodeRequestError = -1,           //Network request return value is abnormal
SAHttpErrorCodeDataLengthError = -2,        //Network request return data length is abnormal
SAHttpErrorCodeUnexpectedError = -3,        //Data parsing has an unknown error
SAHttpErrorCodeDataEmptyError = -4,         //Data is empty
SAHttpErrorCodeDecodeError = -5,            //Data decoding failed
SAHttpErrorCodeDecryptError = -6,           //Data decryption failed
SAHttpErrorCodeServerConfigError = 1001,    //Server data configuration is abnormal
SAHttpErrorCodeServerDecodeError = 1002,    //Server decryption failed
SAHttpErrorCodeRequestDataEmptyError = 1003,//Server request data is empty
SAHttpErrorCodeWrongAppIdError = 1004,      //Wrong App ID
SAHttpErrorCodeServerExceptionError = 9001, //Server unknown error
```